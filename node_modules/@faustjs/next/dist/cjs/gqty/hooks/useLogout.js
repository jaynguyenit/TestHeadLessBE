"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.create = void 0;
const core_1 = require("@faustjs/core");
// eslint-disable-next-line import/extensions
const config_1 = require("@faustjs/core/config");
const isNil_js_1 = __importDefault(require("lodash/isNil.js"));
const react_1 = require("react");
function create() {
    return () => {
        const { apiBasePath } = (0, core_1.config)();
        if ((0, isNil_js_1.default)(apiBasePath)) {
            throw new Error('apiBasePath needs to be defined to use the useLogout hook');
        }
        const [isLoading, setIsLoading] = (0, react_1.useState)(false);
        const [isLoggedOut, setIsLoggedOut] = (0, react_1.useState)(undefined);
        /**
         * Callable function to logout the existing user.
         */
        async function logout() {
            setIsLoading(true);
            const res = await fetch(`${apiBasePath}/${config_1.LOGOUT_ENDPOINT_PARTIAL_PATH}`, {
                method: 'POST',
            });
            setIsLoading(false);
            if (res.ok) {
                setIsLoggedOut(true);
            }
            else {
                setIsLoggedOut(false);
            }
        }
        return { logout, isLoggedOut, isLoading };
    };
}
exports.create = create;
